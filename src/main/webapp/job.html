<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
</html><!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <style>
        a{
            margin: 5px;
            color: blue;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>


<!--<div class="container">-->
    <div class="card  bg-white">

        <div class="card-header bg-light border" >
            <i class="fa fa-list-ul fa-lg ml-2 mr-2" ></i>
            职位信息列表
        </div>
        <div class="card-body">

            <div class="form-row align-items-center">
                <div class="col-auto">


                    <button type="button" data-toggle="modal"  data-target="#staticBackdrop" class="btn btn-primary mb-2 ml-3  "><i class="fa fa-calendar-plus-o fa-lg ml-2 mr-2" ></i>添加部门信息</button>
                    <!-- <input type="button" class=" ml-3  form-control mb-2 btn-primary" id="inlineFormInput"  value="添加学员"> -->
                    <!-- Modal -->
                    <div class="modal fade" id="staticBackdrop" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="staticBackdropLabel">添加职位信息</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form action="/job/add" method="post">
                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <label for="inputEmail4">职位名称</label>
                                                <input type="text" class="form-control" value="" id="inputEmail4" name="jName" required >
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <label for="inputPassword4">职位信息</label>
                                                <input type="text" class="form-control" value="" id="inputPassword4" name="jDesc" required>
                                            </div>
                                        </div>
                                        <div class="form-group col-md-12">
                                            <label>状态</label>
                                            <select class="form-control form-control-sm"  style="height: 40px" id="sel" name="statu">
                                                <option>0</option>
                                                <option>1</option>
                                            </select>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                                            <button type="submit" class="btn btn-primary">提交</button>
                                        </div>
                                    </form>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!--            修改            -->
                    <div class="modal fade" id="UpstaticBackdrop" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">

                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="UpstaticBackdropLabel">修改学员信息</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form action="/job/update" method="post">

                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <label for="UpId">部门ID</label>
                                                <input type="text" class="form-control" value="" id="UpId" name="jId" required readonly>
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <label for="UpinputEmail4">职位名称</label>
                                                <input type="text" class="form-control" value="" id="UpinputEmail4" name="jName" required >
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <label for="UpinputPassword4">职位信息</label>
                                                <input type="text" class="form-control" value="" id="UpinputPassword4" name="jDesc" required>
                                            </div>
                                        </div>
                                        <div class="form-group col-md-12">
                                            <label>状态</label>
                                            <select class="form-control form-control-sm"  style="height: 40px" id="selele" name="statu">
                                                <option>0</option>
                                                <option>1</option>
                                            </select>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                                            <button type="submit" class="btn btn-primary">修改</button>
                                        </div>
                                    </form>

                                </div>
                            </div>

                        </div>
                    </div>
                    <!--             修改完成           -->
                </div>
                <div class="col-auto">
                    <label class="sr-only" for="inlineFormInputGroup">Username</label>
                    <div class="input-group mb-2 ml-3 ">
                        <div class="input-group-prepend mt-1">
                            搜索:
                        </div>
                        <input type="text" id="inp" class="form-control   ml-3" id="inlineFormInputGroup" placeholder="请输入部门名称">
                    </div>
                </div>

                <div class="col-auto">

                    <button type="button" onclick="select()" class="btn btn-primary mb-2 ml-3 "><i class="fa fa-search fa-lg ml-2 mr-2" ></i>搜索</button>
                    <button type="button" onclick="batchDel()" class="btn btn-danger mb-2">删除选择行</button>
                </div>
            </div>
            </form>
        </div>

        <!-- footer -->
        <div class="card-footer text-center bg-white">
            <form method="post" action="/notice/delete" id="deleteJob">
            <table id="tab" class="table bg-white ">
                <thead>
                <th><input type="checkbox" name="check" id="check" value="" /></th>
                <th scope="col">序号</th>
                <th scope="col">职位名称</th>
                <th scope="col">职位信息</th>
                <th scope="col">操作</th>
                </thead>
            </table>
                <select name="pageSize" style="width:160px">
                    <option value="3">3条/页</option>
                    <option  value="6">6条/页</option>
                    <option value="9">9条/页</option>
                    <option value="12">12条/页</option>
                </select>
            </form>
        </div>
    </div>
<!--</div>-->
<script src="jquery-3.4.1.js" type="text/javascript" charset="utf-8"></script>
<script src="js/bootstrap.bundle.js"></script>
<script type="text/javascript">
    $(function () {
        getDeptInFo(1);
    });
//全选按钮
    var inp=document.getElementById("check");
    var ck=document.getElementsByName("ids");
    var k=0;

    inp.onclick=function(){
        for(var i=0;i<ck.length;i++)
            ck[i].checked=this.checked;
    }

    document.getElementById("check").checked=false;
    $("table").on("click","input[name='ids']",function(){

        if(this.checked){
            k++;
        }else{
            k--;
        }
        if(k==ck.length){
            inp.checked = true;

        }else{
            inp.checked=false;
        }
    })

    //批量删除
    function batchDel(){
        var num=0;
        let elementsByName = document.getElementsByName("ids");
        for (var i = 0;i<elementsByName.length;i++){
            if(elementsByName[i].checked){
                num = 1;
            }
        }
        if(num==0){
            alert('最少选择一条数据');
            return false;
        }
        if(confirm('确定删除选择行吗?')){
            $("#deleteJob").submit();
            alert('删除成功');
             getDeptInFo(1);

        }else {
            ;
        }
    };

    function del(num){
        alert(num.value);
        if(confirm('确定要删除吗?')){
            $.post("/job/delete",{"ids":num.value},function(result) {
                if (result){
                    alert('删除成功!');
                    getDeptInFo(1);
                }else {
                    alert('删除失败!');
                }
            });
        };
    }


    var pageNum;
    var pages;
    //异步加载数据
    function getDeptInFo(pageNum){

        $.post("/job/selectAll",{"pageNum":pageNum,"pageSize":4}, function (result) {

            if(result.list==null){
                if(confirm('权限不足，是否重新登陆？')){
                    window.parent.location.href="/login.html";
                }
            }else{
                console.log(result);
            }
            var html = "<tbody>"
            $("#tab").find("tbody").remove();
            //删除p标签里面的超链接
            $("#tab").next("p").remove();
            for (var i = 0; i < result.list.length; i++) {
                var res = result.list[i];
                pageNum = result.pageNum;
                pages = result.pages;
                console.log(res);
                html += "<tr>";
                html+="<td> <input type=\"checkbox\" name=\"ids\" id=\"\" value="+res.jid+"></td>"
                html += "<td>" + (i+1) + "</td><td>" + res.jname + "</td><td>" + res.jdesc + "</td>"
                html += "<td>\n" +
                    "<button type=\"button\" data-toggle=\"modal\"  data-target=\"#UpstaticBackdrop\" class=\"btn border-primary text-primary\"  value=" + res.jid + ">\n" +
                    "<svg class=\"bi bi-pencil-square\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                    " <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\n" +
                    " <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z\" clip-rule=\"evenodd\"/>\n" +
                    "</svg>\n" +
                    "修改</button>\n" +
                    "<button type=\"button\" class=\"btn border-danger text-danger\" onclick=\"del(this)\" value=" + res.jid+ ">\n" +
                    "<svg class=\"bi bi-trash\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                    " <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n" +
                    " <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\" clip-rule=\"evenodd\"/>\n" +
                    "</svg>\n" +
                    "删除</button></td>"
                html += "</tr>"
            }


            var p ="<p>";
            if(pageNum>1){
                p +="<a class=\"text-primary\"onclick='topage("+(result.pageNum-1)+")'>上一页</a>";
            }
            if(pageNum<pages){
                p +="<a class=\"text-primary\"onclick='topage("+(result.pageNum+1)+")'>下一页</a>";
            }
            if(pages>1){
                for (var i = 0;i<pages;i++){
                    p +="<a class=\"text-primary\"onclick='topage("+(i+1)+")'>"+(i+1)+"</a>";
                }
            }
            p+="</p>"
            html += "</tbody>";

            $("#tab").append(html);
            $("#tab").after(p);
        })
    };

    function topage(pageNum){
        k=0;
        document.getElementById("check").checked=false;
        getDeptInFo(pageNum);
    }

    function topageParam(pageNum){
        k=0;
        document.getElementById("check").checked=false;
        SelectName(pageNum);
    }
//根据条件查询
    function select(){

        if($("#inp").val()==''){
            alert('输入数据为空，默认查询所有数据');
            getDeptInFo(1);
            return;
        }

        $.post("/job/selectAll",{"pageNum":1,"pageSize":"4","jName":$("#inp").val()},function (result){
            $("#tab").find("tbody").remove();
            $("#tab").next("p").remove();
            var html = "<tbody>"
            if(result.list.length>0) {
                for (var i = 0; i < result.list.length; i++){
                    pageNum = result.pageNum;
                    pages = result.pages;
                    var res = result.list[i];
                    console.log(res);
                    html += "<tr>";
                    html+="<td> <input type=\"checkbox\" name=\"ids\" id=\"\" value="+res.jid+"></td>"
                    html += "<td>" + (i+1) + "</td><td>" + res.jname + "</td><td>" + res.jdesc + "</td>"
                    html += "<td>\n" +
                        "<button type=\"button\" data-toggle=\"modal\"  data-target=\"#UpstaticBackdrop\" class=\"btn border-primary text-primary\"  value=" + res.jid + ">\n" +
                        "<svg class=\"bi bi-pencil-square\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                        " <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\n" +
                        " <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z\" clip-rule=\"evenodd\"/>\n" +
                        "</svg>\n" +
                        "修改</button>\n" +
                        "<button type=\"button\" class=\"btn border-danger text-danger\" onclick=\"del(this)\" value=" + res.jid+ ">\n" +
                        "<svg class=\"bi bi-trash\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                        " <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n" +
                        " <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\" clip-rule=\"evenodd\"/>\n" +
                        "</svg>\n" +
                        "删除</button></td>"
                    html += "</tr>"
                }
                html += "</tbody>";
                var p="<p>"
                if(result.pageNum>1){
                    p +="<a class=\"text-primary\"onclick='topageParam("+(result.pageNum-1)+")'>上一页</a>"
                }
                if(result.pageNum<result.pages){
                    p +="<a class=\"text-primary\"onclick='topageParam("+(result.pageNum+1)+")'>下一页</a>"
                }
                if(result.pages>1){
                    for (var i = 0;i<pages;i++){
                        p +="<a class=\"text-primary\"onclick='topageParam("+(i+1)+")'>"+(i+1)+"</a>";
                    }
                }
                $("#tab").append(html);
                $("#tab").after(p);
            }else{
                $("#tab").find("tbody").remove();
                //删除p标签里面的超链接
                $("#tab").next("p").remove();
                if(confirm('您查询的数据不存在!')){
                    ;
                }
            }

        })
    }


    //查询Name
    function SelectName(pageNum){

        $.post("/job/selectAll",{"pageNum":pageNum,"pageSize":"4","jName":$("#inp").val()},function (result){
            $("#tab").find("tbody").remove();
            $("#tab").next("p").remove();
            var html = "<tbody>"
            if(result.list.length>0) {
                for (var i = 0; i < result.list.length; i++){
                    var res = result.list[i];
                    console.log(res);
                    html += "<tr>";
                    html+="<td> <input type=\"checkbox\" name=\"ids\" id=\"\" value="+res.jid+"></td>"
                    html += "<td>" + (i+1) + "</td><td>" + res.jname + "</td><td>" + res.jdesc + "</td>"
                    html += "<td>\n" +
                        "<button type=\"button\" data-toggle=\"modal\"  data-target=\"#UpstaticBackdrop\" class=\"btn border-primary text-primary\"  value=" + res.jid + ">\n" +
                        "<svg class=\"bi bi-pencil-square\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                        " <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\n" +
                        " <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z\" clip-rule=\"evenodd\"/>\n" +
                        "</svg>\n" +
                        "修改</button>\n" +
                        "<button type=\"button\" class=\"btn border-danger text-danger\" onclick=\"del(this)\" value=" + res.jid+ ">\n" +
                        "<svg class=\"bi bi-trash\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n" +
                        " <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n" +
                        " <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\" clip-rule=\"evenodd\"/>\n" +
                        "</svg>\n" +
                        "删除</button></td>"
                    html += "</tr>"
                }
                html += "</tbody>";
                var p="<p>"
                if(result.pageNum>1){
                    p +="<a class=\"text-primary\"onclick='topageParam("+(result.pageNum-1)+")'>上一页</a>"
                }
                if(result.pageNum<result.pages){
                    p +="<a onclick='topageParam("+(result.pageNum+1)+")'>下一页</a>"
                }
                if(result.pages>1){
                    for (var i = 0;i<pages;i++){
                        p +="<a class=\"text-primary\"onclick='topageParam("+(i+1)+")'>"+(i+1)+"</a>";
                    }
                }
                $("#tab").append(html);
                $("#tab").after(p);
            }else{
                $("#tab").find("tbody").remove();
                //删除p标签里面的超链接
                $("#tab").next("p").remove();
                if(confirm('您查询的数据不存在!')){
                    ;
                }
            }

        })
    }
    //触发模态窗口事件
    $('#UpstaticBackdrop').on('show.bs.modal', function (event) {
        var jQuery = $("#UpstaticBackdrop input");
        //获取触发模态窗口显示的标签
        var button = $(event.relatedTarget);
        var Arr = new Array();
        $.post("/job/selectById",{"id":button.val()},function(res){
            console.log(res);
            Arr.push(res.jid);
            Arr.push(res.jname);
            Arr.push(res.jdesc);
            for (var i = 0; i < Arr.length; i++){
                $(jQuery)[i].value = Arr[i];
            }
        });
        var recipient = button.data('whatever');
        var modal = $(this)
        modal.find('.modal-title').text('New message to ' + recipient)
        modal.find('.modal-body input').val(recipient)
    });
</script>
</body>
</html>